<!DOCTYPE html>
<html style="display: none;" lang="en">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">














    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            数据驱动在Uiautomator中的使用 | 
        
        Rory
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="Part 1: 前言&amp;emsp;&amp;emsp;本文的基础是Junit4的参数化，如果不了解请阅读或百度Junit4参数化
Part 2： 理论依据&amp;emsp;&amp;emsp;数据驱动的设计思路是，把需要的数据放到excel表格中，然后由程序去读里面的数据，传入程序里进行测试。因此涉及到了两个方面：">
    <meta name="keywords" content=",Uiautomator,Junit">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Rory">
    <meta name="msapplication-starturl" content="http://www.rory.tech/posts/2017/1504263418/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Rory">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://www.rory.tech/posts/2017/1504263418/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="数据驱动在Uiautomator中的使用 | Rory">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="Part 1: 前言&amp;emsp;&amp;emsp;本文的基础是Junit4的参数化，如果不了解请阅读或百度Junit4参数化
Part 2： 理论依据&amp;emsp;&amp;emsp;数据驱动的设计思路是，把需要的数据放到excel表格中，然后由程序去读里面的数据，传入程序里进行测试。因此涉及到了两个方面：">
    <meta property="og:article:tag" content="Uiautomator"> <meta property="og:article:tag" content="Junit"> 

    
        <meta property="article:published_time" content="Fri Sep 01 2017 18:56:58 GMT+0800">
        <meta property="article:modified_time" content="Sun Oct 01 2017 15:34:07 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://www.rory.tech/posts/2017/1504263418/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://www.rory.tech/posts/2017/1504263418/index.html",
    "headline": "数据驱动在Uiautomator中的使用",
    "datePublished": "Fri Sep 01 2017 18:56:58 GMT+0800",
    "dateModified": "Sun Oct 01 2017 15:34:07 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Rory",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "Hi, nice to meet you"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Rory",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",Uiautomator,Junit",
    "description": "Part 1: 前言&amp;emsp;&amp;emsp;本文的基础是Junit4的参数化，如果不了解请阅读或百度Junit4参数化
Part 2： 理论依据&amp;emsp;&amp;emsp;数据驱动的设计思路是，把需要的数据放到excel表格中，然后由程序去读里面的数据，传入程序里进行测试。因此涉及到了两个方面：",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Part-1-前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">Part 1: 前言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Part-2：-理论依据"><span class="post-toc-number">2.</span> <span class="post-toc-text">Part 2： 理论依据</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Part-3：实现步骤"><span class="post-toc-number">3.</span> <span class="post-toc-text">Part 3：实现步骤</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#在AS中添加POI的依赖"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">在AS中添加POI的依赖:</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用POI读取Excel"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">使用POI读取Excel</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Part-3-代码实现"><span class="post-toc-number">4.</span> <span class="post-toc-text">Part 3 代码实现</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#读取Excel部分"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">读取Excel部分</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#单元格判断"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">单元格判断</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#读取单元格里的值"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">读取单元格里的值</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#获取读取到的数据并返回"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">获取读取到的数据并返回</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#在测试中的使用"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">在测试中的使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#定义数据源"><span class="post-toc-number">4.5.1.</span> <span class="post-toc-text">定义数据源</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用构建参数用于数据传递"><span class="post-toc-number">4.5.2.</span> <span class="post-toc-text">使用构建参数用于数据传递</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#编写测试用例"><span class="post-toc-number">4.5.3.</span> <span class="post-toc-text">编写测试用例</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Part-4-总结"><span class="post-toc-number">5.</span> <span class="post-toc-text">Part 4 总结</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#示例和资料"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">示例和资料</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#示例"><span class="post-toc-number">5.1.1.</span> <span class="post-toc-text">示例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">5.1.2.</span> <span class="post-toc-text">参考资料</span></a></li></ol></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                数据驱动在Uiautomator中的使用
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Rory</strong>
        <span>Sep 01, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Junit/">Junit</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/Uiautomator/">Uiautomator</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=数据驱动在Uiautomator中的使用&url=http://www.rory.tech/posts/2017/1504263418/index.html&pic=http://www.rory.tech/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=数据驱动在Uiautomator中的使用&url=http://www.rory.tech/posts/2017/1504263418/index.html&via=Rory" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.rory.tech/posts/2017/1504263418/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://www.rory.tech/posts/2017/1504263418/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="Part-1-前言"><a href="#Part-1-前言" class="headerlink" title="Part 1: 前言"></a>Part 1: 前言</h1><p>&emsp;&emsp;本文的基础是Junit4的参数化，如果不了解请阅读或百度<a href="https://www.baidu.com/s?wd=Junit+4+%E5%8F%82%E6%95%B0%E5%8C%96&amp;ie=utf-8&amp;rsv_op=JV8ML2UfIadPaYb8P23XbMUJhTOc35bcZ680SQN4dYOUIMKL2SK86J6fRVheQ7P6UW3dRO0e9gIIJah65df8Q3hQONeZLIaW&amp;tn=90909841_hao_pg&amp;ch=&amp;rsv_su=4cI4IQXZ7ZQQ7LgTe8IQKafQf0dO5e9e0fg1O0S1II61c8V71WKTXIVSUa9dbf1XeRh0eKNIXL6hSeaf0TaeSQOfJTd0NeVZ" target="_blank" rel="external">Junit4参数化</a><br></p>
<h1 id="Part-2：-理论依据"><a href="#Part-2：-理论依据" class="headerlink" title="Part 2： 理论依据"></a>Part 2： 理论依据</h1><p>&emsp;&emsp;数据驱动的设计思路是，把需要的数据放到excel表格中，然后由程序去读里面的数据，传入程序里进行测试。因此涉及到了两个方面：<br><br><a id="more"></a></p>
<ul>
<li>数据读取</li>
<li>数据分配<br><br>&emsp;&emsp;在数据分配上由于Junit已经实现了，因此只需要把数据读到程序里，形成一个collocation即可。这里需要用到<a href="https://poi.apache.org/" target="_blank" rel="external">POI</a>,使用POI来进行读取Excel的操作。</li>
</ul>
<h1 id="Part-3：实现步骤"><a href="#Part-3：实现步骤" class="headerlink" title="Part 3：实现步骤"></a>Part 3：实现步骤</h1><h2 id="在AS中添加POI的依赖"><a href="#在AS中添加POI的依赖" class="headerlink" title="在AS中添加POI的依赖:"></a>在AS中添加POI的依赖:</h2><p>依赖添加步骤：<br><br>在要添加的jar文件上点击右键，然后选择在弹出菜单中选择Add As Library如下图：<br><br> <img src="Data-Driven-Test-In-Uiautomator/addlibs.png" alt="添加依赖"><br><br>或者直接在build.gradle(App下那个）中的dependencies里添加jar的路劲如下：<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile files(&apos;src/libs/poi-3.17-beta1.jar&apos;)</div></pre></td></tr></table></figure></p>
<h2 id="使用POI读取Excel"><a href="#使用POI读取Excel" class="headerlink" title="使用POI读取Excel"></a>使用POI读取Excel</h2><p>&emsp;&emsp;读取Excel步骤分析：</p>
<ul>
<li>拿到excel表格</li>
<li>拿到表格里的sheet</li>
<li>拿到行和列</li>
<li>拿到单元格数量</li>
<li>判断单元格里的内容并读取。</li>
</ul>
<h1 id="Part-3-代码实现"><a href="#Part-3-代码实现" class="headerlink" title="Part 3 代码实现"></a>Part 3 代码实现</h1><h2 id="读取Excel部分"><a href="#读取Excel部分" class="headerlink" title="读取Excel部分"></a>读取Excel部分</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">//从文件流中读取sheet里的信息，并放到一个Object数组里</div><div class="line">    private Collection&lt;Object[]&gt; readExcelData(final InputStream excelFile)</div><div class="line">            throws IOException &#123;</div><div class="line">        //新建一个Excel工作簿文件</div><div class="line">        HSSFWorkbook workbook = new HSSFWorkbook(excelFile);</div><div class="line"></div><div class="line">        //用来存放行、列、单元格里的数据</div><div class="line">        data = new ArrayList&lt;Object[]&gt;();</div><div class="line">        //获取第一个sheet</div><div class="line">        Sheet sheet = workbook.getSheetAt(0);</div><div class="line">        //统计sheet里不为空的行</div><div class="line">        int numberOfColumns = countNonEmptyColumns(sheet);</div><div class="line">        //新建两个数组用来存放列和列里面的数据</div><div class="line">        List&lt;Object[]&gt; rows = new ArrayList&lt;Object[]&gt;();</div><div class="line">        List&lt;Object&gt; rowData = new ArrayList&lt;Object&gt;();</div><div class="line">        int rowNum = sheet.getPhysicalNumberOfRows();</div><div class="line">        //遍历解析sheet里的数据</div><div class="line">        //  for (Row row : sheet) &#123;</div><div class="line">        for (int i = 1; i &lt; rowNum; i++) &#123;</div><div class="line">            //如果row里的为空，则退出循环</div><div class="line">            Row row = sheet.getRow(i);</div><div class="line">            if (isEmpty(row)) &#123;</div><div class="line">                break;</div><div class="line">            &#125; else &#123;</div><div class="line">                rowData.clear();</div><div class="line">                //循环遍历所有列</div><div class="line">                for (int column = 1; column &lt; numberOfColumns; column++) &#123;</div><div class="line">                    //读取所有列里的内容</div><div class="line">                    Cell cell = row.getCell(column);</div><div class="line"></div><div class="line">                    rowData.add(cellFormatCheck(workbook, cell));</div><div class="line">                &#125;</div><div class="line">                rows.add(rowData.toArray());</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return rows;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="单元格判断"><a href="#单元格判断" class="headerlink" title="单元格判断"></a>单元格判断</h2><p>&emsp;&emsp;在读取单元格里内容时，需要先判断单元格里值的类型。然后根据不同类型在分别读取。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">//判断Row的内容是否为空</div><div class="line"> private boolean isEmpty(final Row row) &#123;</div><div class="line">        Cell firstCell = row.getCell(0);</div><div class="line">        boolean rowIsEmpty = (firstCell == null)</div><div class="line">                || (firstCell.getCellTypeEnum() == CellType.BLANK);</div><div class="line">        return rowIsEmpty;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">/*判断单元格里的公式类型</div><div class="line">如=SUM(A1:E1*&#123;1,2,3,4,5&#125;</div><div class="line">*/</div><div class="line">    private Object evaluateCellFormula(final HSSFWorkbook workbook, final Cell cell) &#123;</div><div class="line">        FormulaEvaluator evaluator = workbook.getCreationHelper()</div><div class="line">                .createFormulaEvaluator();</div><div class="line">        CellValue cellValue = evaluator.evaluate(cell);</div><div class="line">        Object result = null;</div><div class="line"></div><div class="line">        if (cellValue.getCellTypeEnum() == CellType.BOOLEAN) &#123;</div><div class="line">            result = cellValue.getBooleanValue();</div><div class="line">        &#125; else if (cellValue.getCellTypeEnum() == CellType.NUMERIC) &#123;</div><div class="line">            result = cellValue.getNumberValue();</div><div class="line">        &#125; else if (cellValue.getCellTypeEnum() == CellType.STRING) &#123;</div><div class="line">            result = cellValue.getStringValue();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">/*</div><div class="line">     * 判断不为空的行数，通过第一行的不为空的单元格</div><div class="line">     */</div><div class="line">    private int countNonEmptyColumns(final Sheet sheet) &#123;</div><div class="line">        Row firstRow = sheet.getRow(0);</div><div class="line">        return firstEmptyCellPosition(firstRow);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /*</div><div class="line">    获取第一行不为空的单元格数量</div><div class="line">     */</div><div class="line">    private int firstEmptyCellPosition(final Row cells) &#123;</div><div class="line">        int columnCount = 0;</div><div class="line">        for (Cell cell : cells) &#123;</div><div class="line">            if (cell.getCellTypeEnum() == CellType.BLANK) &#123;</div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">            columnCount++;</div><div class="line">        &#125;</div><div class="line">        return columnCount;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<h2 id="读取单元格里的值"><a href="#读取单元格里的值" class="headerlink" title="读取单元格里的值"></a>读取单元格里的值</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">private Object cellFormatCheck(final HSSFWorkbook workbook, final Cell cell) &#123;</div><div class="line">        Object cellValue = null;</div><div class="line">        //判断对应cell（单元格）的值，并读取出来。</div><div class="line">        if (cell.getCellTypeEnum() == CellType.STRING) &#123;</div><div class="line">            cellValue = cell.getRichStringCellValue().getString();</div><div class="line">        &#125; else if (cell.getCellTypeEnum() == CellType.NUMERIC) &#123;</div><div class="line">            cellValue = getNumericCellValue(cell);</div><div class="line">        &#125; else if (cell.getCellTypeEnum() == CellType.BOOLEAN) &#123;</div><div class="line">            cellValue = cell.getBooleanCellValue();</div><div class="line">        &#125; else if (cell.getCellTypeEnum() == CellType.FORMULA) &#123;</div><div class="line">            cellValue = evaluateCellFormula(workbook, cell);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return cellValue;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">//从单元格中读取数字的值</div><div class="line">    private Object getNumericCellValue(final Cell cell) &#123;</div><div class="line">        Object cellValue;</div><div class="line">        if (DateUtil.isCellDateFormatted(cell)) &#123;</div><div class="line">            cellValue = new Date(cell.getDateCellValue().getTime());</div><div class="line">        &#125; else &#123;</div><div class="line">            cellValue = cell.getNumericCellValue();</div><div class="line">        &#125;</div><div class="line">        return cellValue;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="获取读取到的数据并返回"><a href="#获取读取到的数据并返回" class="headerlink" title="获取读取到的数据并返回"></a>获取读取到的数据并返回</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 从传入的文件流里读取excel内容，并放到data集合数组里。</div><div class="line"></div><div class="line">    public ExcelReader(final InputStream excelInputStream) throws IOException &#123;</div><div class="line">        this.data = readExcelData(excelInputStream);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // put the data in collection and return the data.</div><div class="line">    public Collection&lt;Object[]&gt; getData() &#123;</div><div class="line">        return data;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="在测试中的使用"><a href="#在测试中的使用" class="headerlink" title="在测试中的使用"></a>在测试中的使用</h2><h3 id="定义数据源"><a href="#定义数据源" class="headerlink" title="定义数据源"></a>定义数据源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@Parameterized.Parameters</div><div class="line">    public static Collection testDataSource() throws IOException &#123;</div><div class="line">        InputStream excelURL = new FileInputStream(Environment.getExternalStorageDirectory() + &quot;/1.xls&quot;);</div><div class="line">        return new ExcelReader(excelURL).getData();</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="使用构建参数用于数据传递"><a href="#使用构建参数用于数据传递" class="headerlink" title="使用构建参数用于数据传递"></a>使用构建参数用于数据传递</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">private String appName;</div><div class="line">   private String appPackage;</div><div class="line"></div><div class="line">   /*</div><div class="line">   在构建方法里指定参数的对应关系</div><div class="line">    */</div><div class="line">   public DataDrivenTestCase(String target, String result) &#123;</div><div class="line"></div><div class="line">       this.appName = target;</div><div class="line">       this.appPackage = result;</div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h3 id="编写测试用例"><a href="#编写测试用例" class="headerlink" title="编写测试用例"></a>编写测试用例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">@Test</div><div class="line"> public void OpenAppFormList() &#123;</div><div class="line">     try &#123;</div><div class="line">         DemoTools.isClickByDesc(&quot;Apps&quot;);</div><div class="line">         UiScrollable uiScrollable = new UiScrollable(new UiSelector().resourceId(&quot;com.android.launcher3:id/apps_customize_pane_content&quot;));</div><div class="line">         if (DemoTools.getUiDevice().wait(Until.hasObject(By.res(&quot;com.android.launcher3:id/active&quot;)), 5000)) &#123;</div><div class="line">             uiScrollable.setAsHorizontalList();</div><div class="line">             if (uiScrollable.scrollTextIntoView(appName)) &#123;</div><div class="line">                 DemoTools.isClickByText(appName);</div><div class="line">                 Thread.sleep(1000);</div><div class="line">                 Assert.assertTrue(&quot;Test Fail,Package does not match!&quot;, DemoTools.getCurrentPackageName().equals(appPackage));</div><div class="line">             &#125; else &#123;</div><div class="line">                 fail(&quot;The Target Object &quot; + appName + &quot; Not Found!&quot;);</div><div class="line">             &#125;</div><div class="line">         &#125;</div><div class="line"></div><div class="line"></div><div class="line">     &#125; catch (UiObjectNotFoundException e) &#123;</div><div class="line">         e.printStackTrace();</div><div class="line">         Log.i(&quot;BlogDemo&quot;, e.toString());</div><div class="line">     &#125; catch (InterruptedException e) &#123;</div><div class="line">         e.printStackTrace();</div><div class="line">     &#125;</div><div class="line"></div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h1 id="Part-4-总结"><a href="#Part-4-总结" class="headerlink" title="Part 4 总结"></a>Part 4 总结</h1><ul>
<li>构建参数里的参数个数要和表格里给出的列数一致，不然会报参数错误，如图：<br><img src="Data-Driven-Test-In-Uiautomator/grguments_error_20170902163324.png" alt="参数错误"></li>
<li>参数会到该类里所有测试方法都起作用。因此即使在有的测试用例里，没用到相关数据，case依然会执行多次（按数据条数计）</li>
<li>本次的难点在于，从excel里读取数据，然后返回成Junit4要求的格式，折腾了好久，终于搞定。不容易啊</li>
<li>记得添加读取存储的权限哦！</li>
</ul>
<h2 id="示例和资料"><a href="#示例和资料" class="headerlink" title="示例和资料"></a>示例和资料</h2><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p><a href="https://github.com/RoryShen/Blog/tree/DataDriven" target="_blank" rel="external">本次示例</a></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://poi.apache.org/spreadsheet/quick-guide.html#NewWorkbook" target="_blank" rel="external">Busy Developers’ Guide to HSSF and XSSF Features</a><br><br><a href="https://dzone.com/articles/data-driven-tests-junit-4-and" target="_blank" rel="external">Data-driven tests With JUnit 4 and Excel</a><br><br><a href="https://github.com/junit-team/junit4/wiki/Parameterized-tests" target="_blank" rel="external">Parameterized-tests</a><br></p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/posts/2017/1505825374/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/posts/2017/1503803703/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Rory's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        youremail@email.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/09/">September 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">August 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">July 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">May 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">April 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">March 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">2</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Theme - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Rory
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 0000;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
